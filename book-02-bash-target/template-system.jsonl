{"cluster_id": "template-system", "seed_level": 2, "source_files": ["education/book-02-bash-target/05_template_system.md", "src/unifyweaver/core/template_system.pl"], "topics": ["templates", "code-generation", "customization", "named-templates"], "questions": ["How does UnifyWeaver's template system work?", "What are named templates in UnifyWeaver?", "How do I customize generated code with templates?", "What is the template source order?"], "answer": {"text": "## The Template System\n\nUnifyWeaver uses named templates to generate Bash code cleanly.\n\n### Why Templates?\n\n**Bad (concatenation):**\n```prolog\nformat(string(Code), '#!/bin/bash\\n~w() {\\n~w\\n}\\n', [Name, Body]).\n```\n\n**Good (templates):**\n```prolog\nrender_named_template(bash_header, [name=Name, body=Body], Code).\n```\n\n### Template Source Order\n\nTemplates are loaded from multiple sources:\n\n```prolog\n?- set_template_config_default([source_order([file, cached, generated])]).\n```\n\n| Priority | Source | Location |\n|----------|--------|----------|\n| 1 | file | `templates/name.tmpl.sh` |\n| 2 | cached | In-memory cache |\n| 3 | generated | Built-in `template/2` facts |\n\n### Customizing Templates\n\n**Step 1:** Configure to prefer files\n```prolog\n?- set_template_config_default([source_order([file, generated])]).\n```\n\n**Step 2:** Create custom template file\n```bash\n# templates/bash_header.tmpl.sh\n#!/bin/bash\n# Custom header for My Project\n# Description: {{description}}\n```\n\n**Step 3:** Templates auto-load\n```prolog\n?- render_named_template(bash_header, [description='My Script'], Code).\n```\n\n### Template Variables\n\nUse `{{variable}}` syntax:\n\n```bash\n{{pred}}() {\n    local key=\"$1:$2\"\n    [[ -n \"${{{pred}}_data[$key]}\" ]] && echo \"$key\"\n}\n```\n\n### Enabling Caching\n\n```prolog\n?- set_template_config_default([\n    source_order([file, cached, generated]),\n    auto_cache(true)\n]).\n```\n\nCached templates are saved to `templates/cache/` for inspection.", "anchor_question_hash": "f2a9b3c4d5e68750"}}
{"cluster_id": "template-customization", "seed_level": 3, "source_files": ["education/book-02-bash-target/05_template_system.md", "src/unifyweaver/core/template_system.pl"], "topics": ["templates", "override", "theming", "customization"], "questions": ["How do I override built-in templates?", "Can I add custom headers to generated scripts?", "How do I theme UnifyWeaver output?", "What templates can I customize?"], "answer": {"text": "## Overriding Built-in Templates\n\nCustomize generated code without modifying the compiler.\n\n### Available Templates\n\n| Template Name | Purpose |\n|---------------|--------|\n| `bash_header` | Script shebang and header comments |\n| `facts/lookup_binary` | Binary fact lookup function |\n| `facts/stream` | Fact streaming function |\n| `recursion/bfs_loop` | BFS traversal loop |\n| `recursion/visited_check` | Visited tracking logic |\n\n### Override Example: Custom Header\n\n**Create `templates/bash_header.tmpl.sh`:**\n```bash\n#!/bin/bash\n# ========================================\n# Generated by UnifyWeaver\n# Project: {{project_name}}\n# Date: $(date)\n# ========================================\n# Predicate: {{pred}}\n# Description: {{description}}\n```\n\n**Use it:**\n```prolog\n?- set_template_config_default([source_order([file, generated])]).\n?- compile_predicate(ancestor/2, [], Code).\n% Code now includes your custom header\n```\n\n### Override Example: Custom Function Style\n\n**Create `templates/facts/lookup_binary.tmpl.sh`:**\n```bash\n# {{pred}} - Lookup function (custom style)\n{{pred}}() {\n    local arg1=\"$1\" arg2=\"$2\"\n    local key=\"${arg1}:${arg2}\"\n    \n    if [[ -v \"{{pred}}_data[$key]\" ]]; then\n        echo \"$key\"\n        return 0\n    fi\n    return 1\n}\n```\n\n### Benefits\n\n- No compiler modifications needed\n- Project-specific styling\n- Easy to version control templates\n- Can be shared across team", "anchor_question_hash": "a3b4c5d6e7f89012"}}
