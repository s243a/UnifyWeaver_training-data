{"cluster_id": "bash-constraints", "seed_level": 2, "source_files": ["education/book-02-bash-target/03_advanced_constraints.md", "src/unifyweaver/core/constraint_analyzer.pl"], "topics": ["constraints", "unique", "ordered", "deduplication", "bash"], "questions": ["How do constraints affect Bash code generation?", "What deduplication strategies does UnifyWeaver use for Bash?", "What is the difference between sort -u and hash deduplication?", "How do I preserve order while removing duplicates in Bash?"], "answer": {"text": "## Constraints and Bash Code Generation\n\nConstraints control deduplication strategy in generated Bash code.\n\n### Deduplication Strategy Matrix\n\n| unique | unordered | Strategy | Bash Code |\n|--------|-----------|----------|----------|\n| true | true | Sort & Unique | `... \\| sort -u` |\n| true | false | Hash Dedup | `declare -A seen` loop |\n| false | * | None | Raw output |\n\n### Strategy 1: Sort & Unique (Default)\n\n```prolog\n:- constraint(grandparent/2, [unique(true), unordered(true)]).\n```\n\n**Generated:**\n```bash\ngrandparent() {\n    parent_stream | parent_join | sort -u\n}\n```\n\n**Pros:** Fast, efficient  \n**Cons:** Changes order\n\n### Strategy 2: Hash Deduplication\n\n```prolog\n:- constraint(event_log/3, [unique(true), ordered]).\n```\n\n**Generated:**\n```bash\nevent_log_stream() {\n    declare -A seen\n    for key in \"${event_log_data[@]}\"; do\n        if [[ -z \"${seen[$key]}\" ]]; then\n            seen[$key]=1\n            echo \"$key\"\n        fi\n    done\n}\n```\n\n**Pros:** Preserves original order  \n**Cons:** Uses memory for seen hash\n\n### Strategy 3: No Deduplication\n\n```prolog\n:- constraint(raw_log/3, [unique(false), ordered]).\n```\n\n**Generated:**\n```bash\nraw_log_stream() {\n    for key in \"${raw_log_data[@]}\"; do\n        echo \"$key\"\n    done\n}\n```\n\n**Use case:** Counting, raw log processing\n\n### Example: Timeline Events\n\n```prolog\n:- constraint(user_action/3, [unique, ordered]).\n\nuser_action(100, alice, login).\nuser_action(101, bob, login).\nuser_action(102, alice, read_file).\n```\n\nWith `[unique, ordered]`, duplicate actions are removed but chronological order is preserved.", "anchor_question_hash": "e1f9a2b3c4d58760"}}
