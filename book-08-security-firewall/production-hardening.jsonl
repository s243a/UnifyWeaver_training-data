{"cluster_id": "production-001", "question": "How do I configure TLS for UnifyWeaver services?", "answer": "Configure TLS in service declaration and with dedicated predicates:\n\n```prolog\n:- declare_service(api_service, [\n    host('api.example.com'),\n    port(8443),\n    transport(https),\n    tls_version('1.3'),\n    cert_file('/etc/ssl/cert.pem'),\n    key_file('/etc/ssl/key.pem')\n]).\n\n:- declare_tls_config(production, [\n    min_version('1.2'),\n    preferred_version('1.3'),\n    cipher_suites(['TLS_AES_256_GCM_SHA384']),\n    verify_peer(true)\n]).\n```\n\nRemote services without HTTPS will fail validation.", "source_file": "book-08-security-firewall/06_production_hardening.md", "prerequisites": ["security-001"]}
{"cluster_id": "production-001", "question": "How do I manage secrets in UnifyWeaver?", "answer": "Secrets can come from environment variables or external stores:\n\n```prolog\n% Environment variable\n:- declare_secret(api_service, api_key, [\n    source(env('API_KEY')),\n    redact_in_logs(true)\n]).\n\n% HashiCorp Vault\n:- declare_secret(api_service, db_password, [\n    source(vault('secret/data/database', 'password')),\n    vault_addr('https://vault.example.com:8200')\n]).\n\n% AWS Secrets Manager\n:- declare_secret(api_service, api_key, [\n    source(aws_secrets('prod/api-key')),\n    region('us-west-2')\n]).\n```\n\nAlso supports Azure Key Vault and GCP Secret Manager.", "source_file": "book-08-security-firewall/06_production_hardening.md", "prerequisites": ["production-001"]}
{"cluster_id": "production-002", "question": "How do I configure health checks and monitoring?", "answer": "Configure health checks, metrics, and logging:\n\n```prolog\n% Health checks\n:- declare_health_check(api_service, [\n    endpoint('/health'),\n    interval(30),\n    timeout(5),\n    healthy_threshold(2),\n    unhealthy_threshold(3)\n]).\n\n% Prometheus metrics\n:- declare_metrics(api_service, [\n    format(prometheus),\n    endpoint('/metrics'),\n    include([requests_total, request_duration_seconds])\n]).\n\n% Structured logging\n:- declare_logging(api_service, [\n    format(json),\n    level(info),\n    redact([password, api_key, token])\n]).\n```", "source_file": "book-08-security-firewall/06_production_hardening.md", "prerequisites": ["production-001"]}
{"cluster_id": "production-002", "question": "How do I configure alerting in UnifyWeaver?", "answer": "Declare alerts with conditions, duration, severity, and notification channels:\n\n```prolog\n:- declare_alert(api_service, high_error_rate, [\n    condition(error_rate > 0.05),  % >5% errors\n    duration('5m'),\n    severity(critical),\n    notify([pagerduty, slack])\n]).\n\n:- declare_alert(api_service, high_latency, [\n    condition(p99_latency > 500),  % >500ms p99\n    duration('10m'),\n    severity(warning),\n    notify([slack])\n]).\n\n:- declare_alert(api_service, unhealthy, [\n    condition(health_status == unhealthy),\n    duration('1m'),\n    severity(critical),\n    notify([pagerduty, email])\n]).\n```", "source_file": "book-08-security-firewall/06_production_hardening.md", "prerequisites": ["production-002"]}
{"cluster_id": "production-003", "question": "How do I configure resource limits and rate limiting?", "answer": "Set resource limits and rate limiting for protection:\n\n```prolog\n% Resource limits\n:- declare_resource_limits(api_service, [\n    memory_limit('512Mi'),\n    memory_request('256Mi'),\n    cpu_limit('1000m'),        % 1 CPU\n    cpu_request('250m')\n]).\n\n% Connection limits\n:- declare_connection_limits(api_service, [\n    max_connections(1000),\n    connection_timeout(30),\n    idle_timeout(300),\n    max_request_size('10Mi')\n]).\n\n% Rate limiting\n:- declare_rate_limit(api_service, [\n    requests_per_second(100),\n    burst(150),\n    by(client_ip),\n    on_exceed(return_429)\n]).\n```", "source_file": "book-08-security-firewall/06_production_hardening.md", "prerequisites": ["production-002"]}
{"cluster_id": "production-003", "question": "What is the production deployment security checklist?", "answer": "Production checklist:\n\n**Transport Security:**\n- HTTPS enabled for all remote services\n- TLS 1.2+ enforced\n- Strong cipher suites\n- Automatic certificate renewal\n\n**Authentication & Secrets:**\n- Secrets in external vault\n- No secrets in code/config\n- Secret rotation configured\n- Service-to-service mTLS\n\n**Network Security:**\n- Network policies with default deny\n- Egress restricted\n- Rate limiting configured\n\n**Monitoring:**\n- Health checks configured\n- Metrics exported\n- Alerts for critical conditions\n\n**Error Handling:**\n- Retry policies\n- Circuit breakers\n- Fallbacks defined", "source_file": "book-08-security-firewall/06_production_hardening.md", "prerequisites": ["production-001", "production-002"]}
