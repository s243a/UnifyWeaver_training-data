{"cluster_id": "ps-dotnet-001", "question": "How do I use inline C# with the PowerShell target?", "answer": "Use the `dotnet_source` plugin to embed C# code:\n\n```prolog\n:- use_module(library(dotnet_source)).\n\nCSharpCode = '\nusing System;\nnamespace UnifyWeaver.Generated.StringReverser {\n    public class StringReverserHandler {\n        public string ProcessStringReverser(string input) {\n            char[] chars = input.ToCharArray();\n            Array.Reverse(chars);\n            return new string(chars);\n        }\n    }\n}\n',\n\nConfig = [csharp_inline(CSharpCode)],\ndotnet_source:compile_source(string_reverser/2, Config, [], PowerShellCode).\n```\n\n**Generated PowerShell:**\n```powershell\nbegin {\n    Add-Type -TypeDefinition $csharpCode\n    $handler = New-Object UnifyWeaver.Generated.StringReverser.StringReverserHandler\n}\nprocess {\n    $handler.ProcessStringReverser($InputData)\n}\n```", "source_file": "book-12-powershell-target/04_dotnet_integration.md", "prerequisites": ["ps-001"]}
{"cluster_id": "ps-dotnet-001", "question": "How does DLL caching work for 138x speedup?", "answer": "Enable caching with `pre_compile(true)`:\n\n```prolog\nConfig = [csharp_inline(CSharpCode), pre_compile(true)],\ndotnet_source:compile_source(my_pred/2, Config, [], Code).\n```\n\n**How it works:**\n1. Hash the C# source (SHA256)\n2. Check cache: `$env:TEMP/unifyweaver_dotnet_cache/{hash}.dll`\n3. Cache hit: Load existing DLL (~2.8ms)\n4. Cache miss: Compile, save to cache, load (~386ms)\n\n**Generated:**\n```powershell\n$codeHash = Get-StringHash $csharpCode\n$cachedDll = \"$env:TEMP/unifyweaver_dotnet_cache/$codeHash.dll\"\n\nif (Test-Path $cachedDll) {\n    Add-Type -Path $cachedDll  # Fast!\n} else {\n    # Compile and cache...\n}\n```\n\n**Result:** First run ~386ms, subsequent runs ~2.8ms.", "source_file": "book-12-powershell-target/04_dotnet_integration.md", "prerequisites": ["ps-dotnet-001"]}
{"cluster_id": "ps-dotnet-002", "question": "How do I use NuGet packages in PowerShell target?", "answer": "Use `compile_mode(external)` with `references`:\n\n```prolog\nConfig = [\n    csharp_inline(CSharpCode),\n    compile_mode(external),\n    references(['LiteDB', 'System.Text.Json'])\n],\ndotnet_source:compile_source(db_query/3, Config, [], Code).\n```\n\n**Generated process:**\n1. Creates temporary .NET project\n2. Writes `.csproj` with PackageReferences\n3. Runs `dotnet restore` and `dotnet build`\n4. Loads compiled DLL\n5. Creates instance and calls methods\n\n**Example .csproj:**\n```xml\n<Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup><TargetFramework>net8.0</TargetFramework></PropertyGroup>\n  <ItemGroup>\n    <PackageReference Include=\"LiteDB\" Version=\"5.0.0\" />\n  </ItemGroup>\n</Project>\n```\n\nRequires .NET SDK installed.", "source_file": "book-12-powershell-target/04_dotnet_integration.md", "prerequisites": ["ps-dotnet-001"]}
