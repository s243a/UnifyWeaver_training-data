{"cluster_id": "ps-hosting-001", "question": "How does in-process C# hosting work with PowerShell?", "answer": "Generate dual outputs with `compile_with_csharp_host/4`:\n\n```prolog\n?- compile_with_csharp_host(\n       [filter_users/2, transform_data/2],\n       [namespace('MyApp.Generated'), class('DataProcessor')],\n       PSCode,    % PowerShell functions\n       CSharpCode % C# wrapper class\n   ).\n```\n\n**Generated C# host:**\n```csharp\npublic class PowerShellHost {\n    public PowerShellHost(string scriptBlock) { /* init runspace */ }\n    \n    public IEnumerable<dynamic> filter_users(string arg1, string arg2) {\n        var script = \"filter_users $arg1 $arg2\";\n        return PowerShellBridge.Invoke<object, dynamic>(script, null);\n    }\n}\n```\n\n**Usage:**\n```csharp\nvar host = new PowerShellHost(psScript);\nforeach (var user in host.filter_users(\"\", \"\")) {\n    Console.WriteLine($\"ID: {user.X}\");\n}\n```\n\nAdvantage: Zero serialization overhead - objects pass directly.", "source_file": "book-12-powershell-target/06_csharp_hosting.md", "prerequisites": ["ps-dotnet-001"]}
{"cluster_id": "ps-hosting-001", "question": "What bridges does UnifyWeaver support for .NET interop?", "answer": "Three bridge types:\n\n```prolog\n% PowerShell bridge (C# hosts PowerShell)\n?- generate_csharp_bridge(powershell, [namespace('MyApp')], Code).\n\n% IronPython bridge (C# hosts Python - no subprocess)\n?- generate_csharp_bridge(ironpython, [namespace('MyApp')], Code).\n\n% CPython fallback (pipe-based - for numpy, pandas)\n?- generate_csharp_bridge(cpython, [], Code).\n```\n\n**Performance comparison:**\n| Pattern | Latency | Use Case |\n|---------|---------|----------|\n| In-Process | ~0ms | Same AppDomain, direct objects |\n| Pipe-Based | ~5-10ms | Cross-process, JSON serialization |\n\n**Runtime detection:**\n```prolog\n?- dotnet_glue:python_runtime_choice([json, re], Runtime).\nRuntime = ironpython.  % All IronPython-compatible\n\n?- dotnet_glue:python_runtime_choice([numpy], Runtime).\nRuntime = cpython_pipe.  % C extensions need CPython\n```", "source_file": "book-12-powershell-target/06_csharp_hosting.md", "prerequisites": ["ps-hosting-001"]}
