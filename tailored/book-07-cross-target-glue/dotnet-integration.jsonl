{"pair_id": "b7-c7-dotnet-bridges_p0", "cluster_id": "b7-c7-dotnet-bridges", "question": "How do I create .NET bridges?", "question_type": "medium", "answer": "To create .NET bridges in UnifyWeaver, use the bridge generation predicates that produce C# hosting code:\n\n```prolog\n% Generate C# code that hosts PowerShell in-process\ngenerate_powershell_bridge(Options, CSharpCode).\n\n% Generate C# code that hosts IronPython in-process\ngenerate_ironpython_bridge(Options, CSharpCode).\n```\n\nThese bridges leverage in-process execution within the .NET family, eliminating serialization overhead. For example, a PowerShell bridge allows direct object passing:\n\n```csharp\nvar ps = PowerShell.Create();\nps.AddScript(scriptCode);\nvar results = ps.Invoke<OutputType>();  // No serialization needed!\n```\n\nThe runtime automatically handles environment detection, choosing between PowerShell Core and Windows PowerShell, checking for IronPython availability, and falling back to CPython when necessary.\n\nFor implementation details and examples, see education/book-07-cross-target-glue/07_dotnet_bridges.md.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/07_dotnet_bridges.md", "topics": ["dotnet-bridge", "powershell-hosting", "ironpython"], "original_answer": "## .NET Bridge Generation\n\n### In-Process Benefits\n\nFor .NET family, avoid serialization entirely:\n\n```csharp\nvar ps = PowerShell.Create();\nps.AddScript(scriptCode);\nvar results = ps.Invoke<OutputType>();  // Direct object passing!\n```\n\n### Bridge Generation\n\n```prolog\n% C# hosting PowerShell in-process\ngenerate_powershell_bridge(Options, CSharpCode).\n\n% C# hosting IronPython in-process\ngenerate_ironpython_bridge(Options, CSharpCode).\n```\n\n### Runtime Detection\n\nThe system automatically detects:\n- PowerShell Core vs Windows PowerShell\n- IronPython availability\n- CPython fallback", "answer_tailored": true}
{"pair_id": "b7-c7-dotnet-bridges_p1", "cluster_id": "b7-c7-dotnet-bridges", "question": "How does PowerShell in-process hosting work?", "question_type": "medium", "answer": "PowerShell in-process hosting allows you to run PowerShell scripts directly within a .NET application without serialization overhead. You create a PowerShell instance using `PowerShell.Create()`, add your script code with `AddScript()`, and invoke it with direct object passing: `ps.Invoke<OutputType>()`. This returns strongly-typed results without any marshaling costs.\n\nUnifyWeaver generates C# bridge code for this pattern using `generate_powershell_bridge(Options, CSharpCode)`. The runtime automatically detects whether PowerShell Core or Windows PowerShell is available and adapts accordingly.\n\nThis in-process approach is part of UnifyWeaver's .NET family optimization strategy, where C# can host both PowerShell and IronPython directly in the same process. For more details on cross-target bridges, see education/book-07-cross-target-glue/07_dotnet_bridges.md.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/07_dotnet_bridges.md", "topics": ["dotnet-bridge", "powershell-hosting", "ironpython"], "original_answer": "## .NET Bridge Generation\n\n### In-Process Benefits\n\nFor .NET family, avoid serialization entirely:\n\n```csharp\nvar ps = PowerShell.Create();\nps.AddScript(scriptCode);\nvar results = ps.Invoke<OutputType>();  // Direct object passing!\n```\n\n### Bridge Generation\n\n```prolog\n% C# hosting PowerShell in-process\ngenerate_powershell_bridge(Options, CSharpCode).\n\n% C# hosting IronPython in-process\ngenerate_ironpython_bridge(Options, CSharpCode).\n```\n\n### Runtime Detection\n\nThe system automatically detects:\n- PowerShell Core vs Windows PowerShell\n- IronPython availability\n- CPython fallback", "answer_tailored": true}
{"pair_id": "b7-c7-dotnet-bridges_p2", "cluster_id": "b7-c7-dotnet-bridges", "question": "What is generate_powershell_bridge?", "question_type": "medium", "answer": "`generate_powershell_bridge/2` is a Prolog predicate that produces C# code for hosting PowerShell in-process. It takes Options and generates CSharpCode that creates a .NET bridge, allowing C# to execute PowerShell scripts directly without serialization overhead. This leverages PowerShell.Create() to run scripts and get results as typed .NET objects (like `ps.Invoke<OutputType>()`), enabling seamless integration between C# and PowerShell targets.\n\nA related predicate `generate_ironpython_bridge/2` provides similar functionality for IronPython hosting. The runtime automatically detects which PowerShell version (Core vs Windows) and Python implementation (IronPython vs CPython) to use.\n\nFor implementation details, see `education/book-07-cross-target-glue/07_dotnet_bridges.md`.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/07_dotnet_bridges.md", "topics": ["dotnet-bridge", "powershell-hosting", "ironpython"], "original_answer": "## .NET Bridge Generation\n\n### In-Process Benefits\n\nFor .NET family, avoid serialization entirely:\n\n```csharp\nvar ps = PowerShell.Create();\nps.AddScript(scriptCode);\nvar results = ps.Invoke<OutputType>();  // Direct object passing!\n```\n\n### Bridge Generation\n\n```prolog\n% C# hosting PowerShell in-process\ngenerate_powershell_bridge(Options, CSharpCode).\n\n% C# hosting IronPython in-process\ngenerate_ironpython_bridge(Options, CSharpCode).\n```\n\n### Runtime Detection\n\nThe system automatically detects:\n- PowerShell Core vs Windows PowerShell\n- IronPython availability\n- CPython fallback", "answer_tailored": true}
{"pair_id": "b7-c8-ironpython-compat_p0", "cluster_id": "b7-c8-ironpython-compat", "question": "What modules work with IronPython?", "question_type": "medium", "answer": "IronPython works with most of Python's standard library, including modules like `json`, `xml`, `re`, and basic data structures. However, it cannot use C extension modules such as `numpy`, `pandas`, `scipy`, TensorFlow, or PyTorch\u2014these require CPython instead.\n\nUnifyWeaver automatically handles this: when you declare a target with `requires([numpy, pandas])`, the system detects the incompatible dependency and falls back to CPython with pipe-based transport rather than in-process IronPython execution.\n\nThe recommended approach is to start with IronPython for in-process performance, then let the system automatically switch to CPython when C extensions are needed. For more details on cross-target integration, see education/book-07-cross-target-glue/.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/08_ironpython_compat.md", "topics": ["ironpython", "cpython", "compatibility"], "original_answer": "## IronPython Compatibility\n\n### Compatible Modules\n\n- Standard library (most of it)\n- json, xml, re\n- Basic data structures\n\n### Incompatible (Require CPython)\n\n- numpy, pandas, scipy\n- TensorFlow, PyTorch\n- Any C extension module\n\n### Automatic Selection\n\n```prolog\n% System detects numpy usage and uses CPython\n:- declare_target(ml_transform/2, python, [\n    requires([numpy, pandas])\n]).\n\n% Result: Falls back to CPython with pipe transport\n```\n\n### Migration Strategy\n\n1. Start with IronPython (in-process)\n2. Detect C extension usage\n3. Fallback to CPython (pipes)", "answer_tailored": true}
{"pair_id": "b7-c8-ironpython-compat_p1", "cluster_id": "b7-c8-ironpython-compat", "question": "When should I use CPython vs IronPython?", "question_type": "medium", "answer": "Choose **IronPython** when you need in-process .NET integration and your Python code only uses pure Python libraries (standard library, json, xml, re, basic data structures). IronPython runs directly within the .NET CLR, avoiding inter-process communication overhead.\n\nSwitch to **CPython** when your code requires:\n- Scientific computing libraries (numpy, pandas, scipy)\n- Machine learning frameworks (TensorFlow, PyTorch)\n- Any Python package with C extensions\n\nUnifyWeaver handles this automatically. When you declare a target with `declare_target/3` and specify requirements like `requires([numpy, pandas])`, the system detects the C extension dependency and automatically selects CPython with pipe-based transport instead of in-process IronPython.\n\nThe recommended workflow: start with IronPython for .NET integration, and let UnifyWeaver fall back to CPython when it detects incompatible dependencies. See education/book-07-cross-target-glue/08_ironpython_compat.md for implementation details.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/08_ironpython_compat.md", "topics": ["ironpython", "cpython", "compatibility"], "original_answer": "## IronPython Compatibility\n\n### Compatible Modules\n\n- Standard library (most of it)\n- json, xml, re\n- Basic data structures\n\n### Incompatible (Require CPython)\n\n- numpy, pandas, scipy\n- TensorFlow, PyTorch\n- Any C extension module\n\n### Automatic Selection\n\n```prolog\n% System detects numpy usage and uses CPython\n:- declare_target(ml_transform/2, python, [\n    requires([numpy, pandas])\n]).\n\n% Result: Falls back to CPython with pipe transport\n```\n\n### Migration Strategy\n\n1. Start with IronPython (in-process)\n2. Detect C extension usage\n3. Fallback to CPython (pipes)", "answer_tailored": true}
{"pair_id": "b7-c8-ironpython-compat_p2", "cluster_id": "b7-c8-ironpython-compat", "question": "What is incompatible with IronPython?", "question_type": "medium", "answer": "## IronPython Compatibility\n\n### Compatible Modules\n\n- Standard library (most of it)\n- json, xml, re\n- Basic data structures\n\n### Incompatible (Require CPython)\n\n- numpy, pandas, scipy\n- TensorFlow, PyTorch\n- Any C extension module\n\n### Automatic Selection\n\n```prolog\n% System detects numpy usage and uses CPython\n:- declare_target(ml_transform/2, python, [\n    requires([numpy, pandas])\n]).\n\n% Result: Falls back to CPython with pipe transport\n```\n\n### Migration Strategy\n\n1. Start with IronPython (in-process)\n2. Detect C extension usage\n3. Fallback to CPython (pipes)", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/08_ironpython_compat.md", "topics": ["ironpython", "cpython", "compatibility"], "answer_tailored": false}
