{"pair_id": "b7-c5-shell-glue_p0", "cluster_id": "b7-c5-shell-glue", "question": "What is the shell glue module?", "question_type": "medium", "answer": "The shell glue module (`shell_glue`) is a Prolog module that generates complete shell scripts in different languages for pipeline processing. It provides predicates for creating AWK scripts (`generate_awk_script/4`), Python scripts (`generate_python_script/4`), Bash scripts (`generate_bash_script/4`), and pipeline orchestration (`generate_pipeline/3`).\n\nFor example, you can generate an AWK script by specifying a filtering condition, input fields, and output format. Given a condition like `'if (status >= 400) print ip, timestamp, status'` with fields `[ip, timestamp, method, path, status]` and `[format(tsv)]` options, it produces a complete AWK script with proper field separators and variable assignments that filters and outputs the specified columns.\n\nSee education/book-07-cross-target-glue/05_shell_glue.md for complete details on shell script generation capabilities.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/05_shell_glue.md", "topics": ["shell-glue", "awk-generation", "python-generation"], "original_answer": "## Shell Script Generation\n\n### Shell Glue Module\n\n```prolog\n:- module(shell_glue, [\n    generate_awk_script/4,      % Complete AWK script\n    generate_python_script/4,   % Complete Python script\n    generate_bash_script/4,     % Complete Bash script\n    generate_pipeline/3         % Pipeline orchestration\n]).\n```\n\n### AWK Generation Example\n\n```prolog\n?- generate_awk_script(\n    'if (status >= 400) print ip, timestamp, status',\n    [ip, timestamp, method, path, status],\n    [format(tsv)],\n    Script\n).\n```\n\n**Generated AWK:**\n\n```awk\nBEGIN { FS = \"\\t\"; OFS = \"\\t\" }\n{\n    ip = $1; timestamp = $2; status = $5\n    if (status >= 400) print ip, timestamp, status\n}\n```", "answer_tailored": true}
{"pair_id": "b7-c5-shell-glue_p1", "cluster_id": "b7-c5-shell-glue", "question": "How do I generate AWK scripts?", "question_type": "medium", "answer": "To generate AWK scripts in UnifyWeaver, use the `generate_awk_script/4` predicate from the `shell_glue` module:\n\n```prolog\n:- use_module(shell_glue).\n\n?- generate_awk_script(\n    'if (status >= 400) print ip, timestamp, status',\n    [ip, timestamp, method, path, status],\n    [format(tsv)],\n    Script\n).\n```\n\nThis produces a complete AWK script with field separators and variable bindings:\n\n```awk\nBEGIN { FS = \"\\t\"; OFS = \"\\t\" }\n{\n    ip = $1; timestamp = $2; status = $5\n    if (status >= 400) print ip, timestamp, status\n}\n```\n\nThe predicate takes four arguments:\n1. AWK body code (the logic to execute)\n2. Field list (maps column names to AWK variables)\n3. Options (like input/output format)\n4. Generated script output\n\nThe shell glue module handles pipeline orchestration and can also generate Python and Bash scripts using `generate_python_script/4` and `generate_bash_script/4`. For complete details on cross-target shell integration, see education/book-07-cross-target-glue/05_shell_glue.md.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/05_shell_glue.md", "topics": ["shell-glue", "awk-generation", "python-generation"], "original_answer": "## Shell Script Generation\n\n### Shell Glue Module\n\n```prolog\n:- module(shell_glue, [\n    generate_awk_script/4,      % Complete AWK script\n    generate_python_script/4,   % Complete Python script\n    generate_bash_script/4,     % Complete Bash script\n    generate_pipeline/3         % Pipeline orchestration\n]).\n```\n\n### AWK Generation Example\n\n```prolog\n?- generate_awk_script(\n    'if (status >= 400) print ip, timestamp, status',\n    [ip, timestamp, method, path, status],\n    [format(tsv)],\n    Script\n).\n```\n\n**Generated AWK:**\n\n```awk\nBEGIN { FS = \"\\t\"; OFS = \"\\t\" }\n{\n    ip = $1; timestamp = $2; status = $5\n    if (status >= 400) print ip, timestamp, status\n}\n```", "answer_tailored": true}
{"pair_id": "b7-c5-shell-glue_p2", "cluster_id": "b7-c5-shell-glue", "question": "What does generate_awk_script/4 do?", "question_type": "medium", "answer": "The `generate_awk_script/4` predicate creates a complete AWK script from a Prolog-style condition. It takes four arguments: the filtering logic, input field names, formatting options, and the resulting script. \n\nFor example, calling it with the condition `'if (status >= 400) print ip, timestamp, status'`, field list `[ip, timestamp, method, path, status]`, and options `[format(tsv)]` produces an AWK script with proper BEGIN block (setting field separators), variable assignments mapping positional fields, and the filtering logic.\n\nThe generated output includes `BEGIN { FS = \"\\t\"; OFS = \"\\t\" }` for tab-separated values, assigns each field to named variables (`ip = $1; timestamp = $2; status = $5`), then applies the specified condition.\n\nThis is part of UnifyWeaver's shell glue functionality for cross-target integration. For more details on shell script generation and pipeline orchestration, see education/book-07-cross-target-glue/05_shell_glue.md.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/05_shell_glue.md", "topics": ["shell-glue", "awk-generation", "python-generation"], "original_answer": "## Shell Script Generation\n\n### Shell Glue Module\n\n```prolog\n:- module(shell_glue, [\n    generate_awk_script/4,      % Complete AWK script\n    generate_python_script/4,   % Complete Python script\n    generate_bash_script/4,     % Complete Bash script\n    generate_pipeline/3         % Pipeline orchestration\n]).\n```\n\n### AWK Generation Example\n\n```prolog\n?- generate_awk_script(\n    'if (status >= 400) print ip, timestamp, status',\n    [ip, timestamp, method, path, status],\n    [format(tsv)],\n    Script\n).\n```\n\n**Generated AWK:**\n\n```awk\nBEGIN { FS = \"\\t\"; OFS = \"\\t\" }\n{\n    ip = $1; timestamp = $2; status = $5\n    if (status >= 400) print ip, timestamp, status\n}\n```", "answer_tailored": true}
{"pair_id": "b7-c6-pipeline-orchestration_p0", "cluster_id": "b7-c6-pipeline-orchestration", "question": "How do I generate a multi-stage pipeline?", "question_type": "medium", "answer": "To generate a multi-stage pipeline in UnifyWeaver, use the `generate_pipeline/3` predicate:\n\n```prolog\ngenerate_pipeline(\n    [step(Name, Target, Script, Opts), ...],\n    Options,\n    OutputScript\n).\n```\n\nEach step specifies a stage name, target language (bash, python, awk, etc.), the script to execute, and options. Here's an ETL example:\n\n```prolog\nexample_pipeline(Script) :-\n    generate_pipeline(\n        [\n            step(fetch_stage, bash, 'fetch.sh', []),\n            step(transform_stage, python, 'transform.py', []),\n            step(store_stage, awk, 'store.awk', [])\n        ],\n        [input('access.log')],\n        Script\n    ).\n```\n\nThis produces a Bash pipeline that chains the stages:\n\n```bash\n#!/bin/bash\nset -euo pipefail\n\ncat \"access.log\" \\\n    | bash \"fetch.sh\" \\\n    | python3 \"transform.py\" \\\n    | awk -f \"store.awk\"\n```\n\nThe pipeline automatically handles data flow between different target languages. For more on cross-target integration, see education/book-07-cross-target-glue/06_shell_pipelines.md.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/06_shell_pipelines.md", "topics": ["generate-pipeline", "step", "orchestration"], "original_answer": "## Pipeline Orchestration\n\n### generate_pipeline/3\n\n```prolog\ngenerate_pipeline(\n    [step(Name, Target, Script, Opts), ...],\n    Options,\n    OutputScript\n).\n```\n\n### Example: ETL Pipeline\n\n```prolog\nexample_pipeline(Script) :-\n    generate_pipeline(\n        [\n            step(fetch_stage, bash, 'fetch.sh', []),\n            step(transform_stage, python, 'transform.py', []),\n            step(store_stage, awk, 'store.awk', [])\n        ],\n        [input('access.log')],\n        Script\n    ).\n```\n\n**Generated Bash:**\n\n```bash\n#!/bin/bash\nset -euo pipefail\n\ncat \"access.log\" \\\n    | bash \"fetch.sh\" \\\n    | python3 \"transform.py\" \\\n    | awk -f \"store.awk\"\n```", "answer_tailored": true}
{"pair_id": "b7-c6-pipeline-orchestration_p1", "cluster_id": "b7-c6-pipeline-orchestration", "question": "What is generate_pipeline/3?", "question_type": "medium", "answer": "`generate_pipeline/3` is a predicate that orchestrates multi-stage pipelines by chaining together scripts written in different target languages. It takes three arguments:\n\n1. A list of `step(Name, Target, Script, Options)` entries, where each step specifies a pipeline stage with its target language and script\n2. Pipeline options (like input file specification)\n3. The unified output script that connects all stages\n\nFor example, you can chain Bash, Python, and AWK scripts into a single pipeline:\n\n```prolog\nexample_pipeline(Script) :-\n    generate_pipeline(\n        [\n            step(fetch_stage, bash, 'fetch.sh', []),\n            step(transform_stage, python, 'transform.py', []),\n            step(store_stage, awk, 'store.awk', [])\n        ],\n        [input('access.log')],\n        Script\n    ).\n```\n\nThis generates a unified Bash script that pipes data through each stage:\n\n```bash\n#!/bin/bash\nset -euo pipefail\n\ncat \"access.log\" \\\n    | bash \"fetch.sh\" \\\n    | python3 \"transform.py\" \\\n    | awk -f \"store.awk\"\n```\n\nSee education/book-07-cross-target-glue/06_shell_pipelines.md for complete pipeline orchestration details.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/06_shell_pipelines.md", "topics": ["generate-pipeline", "step", "orchestration"], "original_answer": "## Pipeline Orchestration\n\n### generate_pipeline/3\n\n```prolog\ngenerate_pipeline(\n    [step(Name, Target, Script, Opts), ...],\n    Options,\n    OutputScript\n).\n```\n\n### Example: ETL Pipeline\n\n```prolog\nexample_pipeline(Script) :-\n    generate_pipeline(\n        [\n            step(fetch_stage, bash, 'fetch.sh', []),\n            step(transform_stage, python, 'transform.py', []),\n            step(store_stage, awk, 'store.awk', [])\n        ],\n        [input('access.log')],\n        Script\n    ).\n```\n\n**Generated Bash:**\n\n```bash\n#!/bin/bash\nset -euo pipefail\n\ncat \"access.log\" \\\n    | bash \"fetch.sh\" \\\n    | python3 \"transform.py\" \\\n    | awk -f \"store.awk\"\n```", "answer_tailored": true}
{"pair_id": "b7-c6-pipeline-orchestration_p2", "cluster_id": "b7-c6-pipeline-orchestration", "question": "How do I define pipeline steps?", "question_type": "medium", "answer": "To define pipeline steps, use the `step/4` structure within `generate_pipeline/3`:\n\n```prolog\ngenerate_pipeline(\n    [step(StepName, TargetLanguage, ScriptPath, Options), ...],\n    PipelineOptions,\n    Result\n).\n```\n\nEach step specifies:\n- `StepName`: Identifier for the pipeline stage\n- `TargetLanguage`: Target execution environment (bash, python, awk, etc.)\n- `ScriptPath`: Path to the script file\n- `Options`: Step-specific configuration (empty list `[]` if none)\n\n**ETL Pipeline Example:**\n\n```prolog\nexample_pipeline(Script) :-\n    generate_pipeline(\n        [\n            step(fetch_stage, bash, 'fetch.sh', []),\n            step(transform_stage, python, 'transform.py', []),\n            step(store_stage, awk, 'store.awk', [])\n        ],\n        [input('access.log')],\n        Script\n    ).\n```\n\nThis generates a shell pipeline connecting the steps:\n\n```bash\n#!/bin/bash\nset -euo pipefail\n\ncat \"access.log\" \\\n    | bash \"fetch.sh\" \\\n    | python3 \"transform.py\" \\\n    | awk -f \"store.awk\"\n```\n\nFor more on cross-target orchestration, see education/book-07-cross-target-glue/06_shell_pipelines.md.", "answer_variant": "default", "answer_source": "education/book-07-cross-target-glue/06_shell_pipelines.md", "topics": ["generate-pipeline", "step", "orchestration"], "original_answer": "## Pipeline Orchestration\n\n### generate_pipeline/3\n\n```prolog\ngenerate_pipeline(\n    [step(Name, Target, Script, Opts), ...],\n    Options,\n    OutputScript\n).\n```\n\n### Example: ETL Pipeline\n\n```prolog\nexample_pipeline(Script) :-\n    generate_pipeline(\n        [\n            step(fetch_stage, bash, 'fetch.sh', []),\n            step(transform_stage, python, 'transform.py', []),\n            step(store_stage, awk, 'store.awk', [])\n        ],\n        [input('access.log')],\n        Script\n    ).\n```\n\n**Generated Bash:**\n\n```bash\n#!/bin/bash\nset -euo pipefail\n\ncat \"access.log\" \\\n    | bash \"fetch.sh\" \\\n    | python3 \"transform.py\" \\\n    | awk -f \"store.awk\"\n```", "answer_tailored": true}
