{"cluster_id": "b5-c5-semantic-overview", "seed_level": 2, "source_files": ["education/book-05-python-target/05_semantic_predicates.md"], "topics": ["semantic-predicates", "ai-features", "python-runtime"], "questions": ["What are semantic predicates in the Python target?", "What AI capabilities does the Python runtime provide?", "How do semantic predicates work?"], "answer": {"text": "## Semantic Predicates\n\nSemantic predicates bridge Prolog logic with AI capabilities.\n\n| Predicate | Purpose | Runtime Component |\n|-----------|---------|-------------------|\n| `semantic_search/3` | Vector similarity | PtSearcher |\n| `graph_search/4` | Graph RAG | PtSearcher |\n| `crawler_run/2` | Web/XML crawling | PtCrawler |\n| `upsert_object/3` | Database storage | PtImporter |\n| `llm_ask/3` | LLM Q&A | LLMProvider |\n\n### Runtime Architecture\n\n```\n┌─────────────────────────────────┐\n│    Generated Python Script      │\n├─────────────────────────────────┤\n│ PtSearcher  PtCrawler  PtImporter│\n├─────────────────────────────────┤\n│ OnnxEmbeddingProvider  LLMProvider│\n├─────────────────────────────────┤\n│        SQLite Database          │\n└─────────────────────────────────┘\n```", "anchor_question_hash": "b5c5001a"}}
{"cluster_id": "b5-c5-vector-search", "seed_level": 3, "source_files": ["education/book-05-python-target/05_semantic_predicates.md"], "topics": ["semantic-search", "vector-search", "cosine-similarity"], "questions": ["How does semantic_search/3 work?", "What is vector similarity search?", "How are query embeddings generated?"], "answer": {"text": "## Vector Search (semantic_search/3)\n\nPerforms vector similarity search against stored embeddings.\n\n### Prolog\n\n```prolog\nfind_physics_content(Results) :-\n    semantic_search('quantum physics', 10, Results).\n```\n\n### How It Works\n\n1. **Query embedding** - Convert query text to vector using ONNX\n2. **Cosine similarity** - Compare query vector against stored embeddings\n3. **Top-K selection** - Return K most similar items\n4. **Result enrichment** - Fetch full object data\n\n### Result Format\n\n```python\n[\n    {\n        'id': 'doc_123',\n        'score': 0.89,\n        'type': 'article',\n        'data': {'title': 'Quantum Entanglement', ...}\n    }\n]\n```\n\n### ONNX Models\n\n- `all-MiniLM-L6-v2` (384 dims, fast)\n- `all-mpnet-base-v2` (768 dims, higher quality)", "anchor_question_hash": "b5c5002a"}}
{"cluster_id": "b5-c5-graph-rag", "seed_level": 3, "source_files": ["education/book-05-python-target/05_semantic_predicates.md"], "topics": ["graph-search", "graph-rag", "multi-hop"], "questions": ["What is Graph RAG?", "How does graph_search/4 work?", "What are hops in graph search?"], "answer": {"text": "## Graph Search (Graph RAG)\n\n`graph_search/4` performs multi-hop graph-based retrieval.\n\n### Prolog\n\n```prolog\nfind_context(Query, Context) :-\n    graph_search(Query, 5, 2, Context).\n```\n\n### How Graph Search Works\n\n1. **Anchor search** - Find top-K nodes via vector similarity\n2. **Expansion** - For each anchor, find connected nodes\n3. **Hop iteration** - Repeat expansion for specified hops\n4. **Context assembly** - Combine into structured result\n\n### Result Structure\n\n```python\n{\n    'anchors': [...],    # Most similar nodes\n    'parents': [...],    # Parent nodes\n    'children': [...],   # Child nodes\n    'hop_2': {\n        'parents': [...],\n        'children': [...]\n    }\n}\n```\n\n### Hop Guidelines\n\n- 1 hop: Fast, focused\n- 2 hops: Good balance\n- 3+ hops: Slow, may include noise", "anchor_question_hash": "b5c5003a"}}
{"cluster_id": "b5-c5-crawling-llm", "seed_level": 3, "source_files": ["education/book-05-python-target/05_semantic_predicates.md"], "topics": ["crawler", "llm-integration", "upsert"], "questions": ["How do I crawl web pages with semantic predicates?", "How does LLM integration work?", "How do I store objects in the database?"], "answer": {"text": "## Crawling and LLM Integration\n\n### Crawling (crawler_run/2)\n\n```prolog\ncrawl_documentation(Seeds) :-\n    crawler_run(['https://docs.example.com/'], 3).\n```\n\n- Streaming XML parsing with lxml\n- Automatic embedding generation\n- Graph construction from links\n\n### LLM Integration (llm_ask/3)\n\n```prolog\nanswer_question(Question, Answer) :-\n    graph_search(Question, 5, 2, Context),\n    llm_ask(Question, Context, Answer).\n```\n\nDefault implementation uses `gemini` CLI.\n\n### Database Storage (upsert_object/3)\n\n```prolog\nstore_article(Id, Title, Content) :-\n    upsert_object(Id, 'article', _{title: Title, content: Content}).\n```\n\n### Database Schema\n\n- `objects` - id, type, data (JSON)\n- `embeddings` - id, vector (BLOB)\n- `links` - source_id, target_id", "anchor_question_hash": "b5c5004a"}}
