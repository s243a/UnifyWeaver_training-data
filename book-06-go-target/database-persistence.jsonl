{"cluster_id": "b6-a3-boltdb-schema", "seed_level": 2, "source_files": ["education/book-06-go-target/A3_database_persistence.md"], "topics": ["boltdb", "database-schema", "bucket-organization"], "questions": ["How does BoltDB store facts in Go target?", "What is the BoltDB schema?", "How are facts organized in buckets?"], "answer": {"text": "## BoltDB Schema in Go Target\n\n### Storage Format\n\n| Component | Format |\n|-----------|--------|\n| Keys | `[]byte` (string converted) |\n| Values | JSON-marshaled `map[string]interface{}` |\n| Encoding | UTF-8 strings, JSON objects |\n\n### Bucket Organization\n\nEach predicate gets its own bucket:\n\n```go\ndb.Update(func(tx *bolt.Tx) error {\n    _, err := tx.CreateBucketIfNotExists([]byte(\"ancestor\"))\n    return err\n})\n```\n\n### Example Stored Record\n\n```json\n{\"relation\":\"ancestor\",\"args\":{\"arg0\":\"john\",\"arg1\":\"mary\"}}\n```\n\n**Library:** `go.etcd.io/bbolt v1.3.8`", "anchor_question_hash": "b6a3001a"}}
{"cluster_id": "b6-a3-key-strategies", "seed_level": 2, "source_files": ["education/book-06-go-target/A3_database_persistence.md"], "topics": ["key-strategies", "composite-keys", "hash-keys"], "questions": ["What key strategies does Go target support?", "How do I use composite keys in BoltDB?", "What is db_key_strategy?"], "answer": {"text": "## BoltDB Key Strategies\n\n### Single Field Key (Default)\n\n```prolog\ncompile_predicate_to_go(user/2, [\n    db_backend(bbolt),\n    db_key_field(name)\n], Code).\n```\n\nGenerated key: `\"Alice\"`, `\"Bob\"`\n\n### Composite Keys\n\n```prolog\ndb_key_strategy(composite([field(dept), field(name)])),\ndb_key_delimiter(':')\n```\n\nGenerated keys: `\"eng:Alice\"`, `\"sales:Bob\"`\n\n### Hash Keys\n\n```prolog\ndb_key_strategy(hash(field(content)))\n```\n\nGenerated key: SHA-256 hex digest\n\n### Composite with Hash\n\n```prolog\ndb_key_strategy(composite([field(name), hash(field(content))]))\n```\n\nGenerated key: `\"readme:a3f2b1c9...\"`", "anchor_question_hash": "b6a3002a"}}
{"cluster_id": "b6-a3-query-outside", "seed_level": 3, "source_files": ["education/book-06-go-target/A3_database_persistence.md"], "topics": ["query-database", "external-access", "go-api"], "questions": ["How do I query BoltDB outside generated programs?", "Can I access the database directly?", "How do I read BoltDB data in custom Go code?"], "answer": {"text": "## Querying BoltDB Outside Generated Programs\n\n### Option 1: Custom Go Code\n\n```go\ndb, _ := bolt.Open(\"users.db\", 0600, &bolt.Options{ReadOnly: true})\ndefer db.Close()\n\ndb.View(func(tx *bolt.Tx) error {\n    bucket := tx.Bucket([]byte(\"users\"))\n    v := bucket.Get([]byte(\"Alice\"))\n    // v is JSON bytes\n    return nil\n})\n```\n\n### Option 2: Runtime Store Wrapper\n\n```go\nimport \"unifyweaver/targets/go_runtime/storage\"\n\nstore, _ := storage.NewStore(\"users.db\")\nobj, _ := store.GetObject(\"Alice\")  // map[string]interface{}\n```\n\n### Option 3: Export to JSON\n\n```bash\n./query_users > all_users.jsonl\n```", "anchor_question_hash": "b6a3003a"}}
{"cluster_id": "b6-a3-incremental", "seed_level": 3, "source_files": ["education/book-06-go-target/A3_database_persistence.md"], "topics": ["incremental-computation", "persistence", "datalog"], "questions": ["How does incremental Datalog work with BoltDB?", "Can I add facts to an existing database?", "How does persistence enable incremental computation?"], "answer": {"text": "## Incremental Datalog with BoltDB\n\n### Workflow\n\n```bash\n# First run - compute and persist\n./ancestor\n\n# Add new facts - continue from saved state\necho '{\"relation\":\"parent\",...}' | ./ancestor\n\n# Query persisted results\n./query_ancestors\n```\n\n### How It Works\n\n1. Load existing facts from database\n2. Add new input facts from stdin\n3. Run fixpoint until no new derivations\n4. Persist new facts to database\n\n### Configuration\n\n```prolog\ncompile_predicate_to_go(ancestor/2, [\n    mode(generator),\n    db_backend(bbolt),\n    db_file('ancestry.db'),\n    json_input(true)\n], Code).\n```", "anchor_question_hash": "b6a3004a"}}
