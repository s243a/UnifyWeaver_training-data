{"cluster_id": "runtime-architecture", "seed_level": 2, "source_files": ["education/book-03-csharp-target/04_runtime_libraries_deployment.md"], "topics": ["runtime", "architecture", "deployment"], "questions": ["What is the C# runtime architecture?", "What components make up the Query Runtime?", "How are generated code and runtime related?", "What is the QueryEngine?"], "answer": {"text": "## Runtime Architecture\n\n```\nYour Application\n    ↓ uses\nUnifyWeaver.Runtime.dll  ← Shared query engine\n    ↓ executes\nQueryPlan (IR)  ← Generated from Prolog\n    ↓ operates on\nData (facts, computed results)\n```\n\n### Core Runtime Library\n\n- **`QueryEngine.cs`**: Fixpoint iteration engine\n- **`IR.cs`**: IR data structures (RelationRef, Join, etc.)\n- **`SemiNaiveEvaluator.cs`**: Optimization logic\n- **`TupleStore.cs`**: In-memory tuple storage\n\n### Generated Code\n\n- Query plans (IR instances)\n- Base fact data\n- Entry points (Main methods)\n\n### Mutual Fixpoint Artifacts (v0.1)\n\n- `MutualFixpointNode` - Coordinator for SCCs\n- `MutualMember` - Pairs predicate with plans\n- `CrossRefNode` - Reference to peer predicate\n- `EvaluationContext` - Tracks totals/deltas\n- `HashSet<object[]>` - Bash-parity deduplication", "anchor_question_hash": "03e1f2a3b4c50001"}}
{"cluster_id": "dotnet-deployment", "seed_level": 2, "source_files": ["education/book-03-csharp-target/04_runtime_libraries_deployment.md"], "topics": ["deployment", "publish", "cross-platform", "nuget"], "questions": ["How do I deploy C# generated code?", "How do I create a NuGet package?", "What are the deployment options?", "How do I publish for different platforms?"], "answer": {"text": "## Deployment Scenarios\n\n### Console Application\n\n```bash\ndotnet publish -c Release -r linux-x64 --self-contained\n# Output: bin/Release/net6.0/linux-x64/publish/\n```\n\n### Cross-Platform Publishing\n\n**Windows:**\n```bash\ndotnet publish -r win-x64 --self-contained\n```\n\n**Linux:**\n```bash\ndotnet publish -r linux-x64 --self-contained\n```\n\n**macOS:**\n```bash\ndotnet publish -r osx-x64 --self-contained\n```\n\n### Deployment Types\n\n**Framework-Dependent (smaller):**\n```bash\ndotnet publish -c Release\n# ~200KB, requires .NET runtime on target\n```\n\n**Self-Contained (no dependencies):**\n```bash\ndotnet publish -c Release -r linux-x64 --self-contained\n# ~60MB, includes .NET runtime\n```\n\n**Single-File:**\n```bash\ndotnet publish -c Release -r linux-x64 \\\n    --self-contained \\\n    -p:PublishSingleFile=true\n```\n\n### NuGet Package\n\n```bash\ndotnet new classlib -n UnifyWeaver.Runtime\ndotnet pack -c Release\n# Generates: bin/Release/UnifyWeaver.Runtime.1.0.0.nupkg\n```", "anchor_question_hash": "03e2f3a4b5c60002"}}
{"cluster_id": "csharp-testing", "seed_level": 2, "source_files": ["education/book-03-csharp-target/04_runtime_libraries_deployment.md", "education/book-03-csharp-target/03_query_engine_deep_dive.md"], "topics": ["testing", "skip-execution", "validation", "ci-cd"], "questions": ["How do I test C# Query Runtime?", "What is SKIP_CSHARP_EXECUTION?", "How do I validate generated code without running it?", "How do I set up CI/CD for UnifyWeaver?"], "answer": {"text": "## Testing the Query Runtime\n\n### Skip Execution Mode\n\nValidate without running dotnet:\n\n```bash\nSKIP_CSHARP_EXECUTION=1 swipl -q \\\n    -f tests/core/test_csharp_query_target.pl \\\n    -g test_csharp_query_target:test_csharp_query_target \\\n    -t halt\n```\n\nCovers: facts, joins, selections, arithmetic, linear/mutual recursion.\n\n### Build-First Workflow\n\n1. Generate project under `output/csharp/<uuid>/`\n2. Run `dotnet build --no-restore`\n3. Execute the compiled binary\n4. Verify output (e.g., `0, 2, 4` for even/odd)\n\n### Unit Tests (xUnit)\n\n```csharp\n[Fact]\npublic void Execute_ShouldReturnAllAncestors()\n{\n    var ancestors = AncestorQuery.Execute().ToList();\n    Assert.Contains((\"alice\", \"bob\"), ancestors);\n    Assert.Contains((\"alice\", \"dave\"), ancestors);\n}\n```\n\n### GitHub Actions CI\n\n```yaml\nsteps:\n- name: Setup .NET\n  uses: actions/setup-dotnet@v1\n  with:\n    dotnet-version: 6.0.x\n\n- name: Generate C# from Prolog\n  run: swipl -g \"compile_all, halt\"\n\n- name: Build and Test\n  run: |\n    dotnet build\n    dotnet test\n```", "anchor_question_hash": "03e3f4a5b6c70003"}}
