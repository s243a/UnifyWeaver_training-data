{"cluster_id": "firewall-001", "question": "How do I declare a firewall policy in UnifyWeaver?", "answer": "Firewall policies are declared in .firewall files using Prolog predicates:\n\n```prolog\n% Set enforcement mode\n:- firewall_mode(enforce).\n\n% Allow specific targets\n:- allow(target(bash)).\n:- allow(target(go)).\n\n% Deny specific targets\n:- deny(target(python)).\n\n% Deny compilation\n:- deny(compile(native)).\n\n% Deny modules\n:- deny(import_module(library(http/_))).\n```\n\nUse `allow/1` to permit, `deny/1` to block, and `require/1` for mandatory conditions.", "source_file": "book-08-security-firewall/02_firewall_policies.md", "prerequisites": ["security-001"]}
{"cluster_id": "firewall-001", "question": "What firewall policy predicates are available?", "answer": "Four main predicates: (1) `allow/1` - explicitly permit operations like `allow(target(go))`; (2) `deny/1` - explicitly deny operations like `deny(compile(native))`; (3) `require/1` - make conditions mandatory like `require(validation(passed))`; (4) `implies/2` - conditional policies like `implies(compile(native), code_review(required))`. Policies can be composed with AND (multiple conditions), OR (multiple rules), and NOT (`\\+` negation).", "source_file": "book-08-security-firewall/02_firewall_policies.md", "prerequisites": ["security-001"]}
{"cluster_id": "firewall-002", "question": "How do I create a target whitelist firewall policy?", "answer": "Create a whitelist by allowing specific targets then denying all others:\n\n```prolog\n% .firewall - Target whitelist\n:- allow(target(bash)).\n:- allow(target(go)).\n:- allow(target(rust)).\n:- deny(target(_)).  % Deny all others\n```\n\nThe underscore `_` matches any target not previously allowed, creating a secure default-deny policy.", "source_file": "book-08-security-firewall/02_firewall_policies.md", "prerequisites": ["firewall-001"]}
{"cluster_id": "firewall-002", "question": "How do I create environment-specific firewall policies?", "answer": "Use conditional rules based on environment:\n\n```prolog\n% Development: permissive\n:- allow(target(_)) :- environment(development).\n:- allow(compile(_)) :- environment(development).\n\n% Production: strict\n:- allow(target(go)) :- environment(production).\n:- allow(target(rust)) :- environment(production).\n:- deny(target(python)) :- environment(production).\n:- require(validation(passed)) :- environment(production).\n```\n\nDifferent .firewall files can be loaded per environment.", "source_file": "book-08-security-firewall/02_firewall_policies.md", "prerequisites": ["firewall-001"]}
{"cluster_id": "firewall-003", "question": "How do I debug firewall policies?", "answer": "Three methods: (1) Trace mode shows decision process:\n```prolog\n:- set_firewall_flag(trace, true).\n% Shows: [Firewall] Checking: target(python)\n%        [Firewall] Rule 3: deny(target(python)) - MATCH\n```\n\n(2) List policies: `?- list_firewall_rules.`\n\n(3) Dry run tests policies without executing:\n```prolog\n?- firewall_dry_run([check(target(python)), check(target(go))], Results).\nResults = [denied(target(python)), allowed(target(go))].\n```", "source_file": "book-08-security-firewall/02_firewall_policies.md", "prerequisites": ["firewall-001"]}
