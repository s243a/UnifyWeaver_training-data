{"cluster_id": "ai-lda-001", "question": "What is LDA projection and how does it work?", "answer": "LDA projection learns a matrix W that transforms question embeddings to be closer to their answer embeddings:\n\n```\nprojected_query = query_embedding @ W\n```\n\n**Dimensions:**\n- `query_embedding`: shape (d,) - e.g., 384 dimensions\n- `W`: shape (d, d) - the learned projection\n- `projected_query`: shape (d,) - now closer to answer space\n\n**Example improvement:**\n```\nQuery:    \"How do I read a CSV file?\"\nDocument: \"The pandas.read_csv() function loads comma-separated...\"\n\nDirect similarity: 0.45 (mediocre)\nAfter projection:  0.89 (much better)\n```\n\nTypical recall improvement: 70% → 93%.", "source_file": "book-14-ai-training/03_lda_projection.md", "prerequisites": ["ai-foundations-001"]}
{"cluster_id": "ai-lda-001", "question": "How is the W matrix computed?", "answer": "Using the Moore-Penrose **pseudoinverse**:\n\n```\nQ = stack of question embeddings  (n × d)\nA = stack of answer embeddings    (n × d)\n\nGoal: Find W such that Q @ W ≈ A\n\nSolution: W = pinv(Q) @ A\n```\n\n**Why pseudoinverse?**\n- Minimizes ||Q @ W - A||² (reconstruction error)\n- Works even when Q is not square or full rank\n- Numerically stable with regularization\n\n```python\nimport numpy as np\n\ndef compute_W(question_embeddings, answer_embeddings, regularization=1e-6):\n    Q = question_embeddings\n    A = answer_embeddings\n    d = Q.shape[1]\n    \n    # Regularized pseudoinverse: (Q^T Q + λI)^-1 Q^T\n    QTQ = Q.T @ Q + regularization * np.eye(d)\n    W = np.linalg.solve(QTQ, Q.T @ A)\n    \n    return W\n```", "source_file": "book-14-ai-training/03_lda_projection.md", "prerequisites": ["ai-lda-001"]}
{"cluster_id": "ai-lda-001", "question": "What's the limitation of single W matrix projection?", "answer": "A single W matrix assumes one global mapping from questions to answers.\n\n**Works well when:**\n- Questions are semantically similar\n- There's one dominant pattern\n\n**Struggles when:**\n- Questions span diverse topics\n- Different question types need different mappings\n\n**Examples of different question types:**\n- \"How do I authenticate?\" → needs auth-domain knowledge\n- \"What's the CSV format?\" → needs data-domain knowledge\n- \"Why is my query slow?\" → needs performance-domain knowledge\n\n**Solution:** Multi-head routing (Chapter 4) with cluster-specific projections.", "source_file": "book-14-ai-training/03_lda_projection.md", "prerequisites": ["ai-lda-001"]}
