{"cluster_id": "sql-func-001", "question": "How do I handle NULL values in the SQL target?", "answer": "**COALESCE** - first non-NULL value:\n```prolog\nemployee_with_dept(Name, Dept) :-\n    employees(_, Name, D, _, _, _),\n    Dept = sql_coalesce([D, 'Unknown']).\n```\n\n**NULLIF** - return NULL if values equal:\n```prolog\nproduct_real_price(Name, Price) :-\n    products(_, Name, _, P, _, _),\n    Price = sql_nullif(P, 0).  % Treat 0 as NULL\n```\n\n**IS NULL / IS NOT NULL** - test for NULL:\n```prolog\nunshipped_orders(Id) :-\n    orders(Id, _, _, ShipDate, _),\n    sql_is_null(ShipDate).\n\nshipped_orders(Id, ShipDate) :-\n    orders(Id, _, _, ShipDate, _),\n    sql_is_not_null(ShipDate).\n```", "source_file": "book-10-sql-target/10_sql_functions.md", "prerequisites": ["sql-basic-001"]}
{"cluster_id": "sql-func-001", "question": "What string functions does the SQL target support?", "answer": "```prolog\n% CONCAT - concatenate values\nInfo = sql_concat([Name, ' - ', Dept])\n\n% UPPER / LOWER - change case\nUpper = sql_upper(Name)\nLower = sql_lower(Name)\n\n% SUBSTRING - extract part of string\nInitials = sql_substring(Name, 1, 1)\n\n% TRIM / LTRIM / RTRIM - remove whitespace\nTrimmed = sql_trim(Name)\nLeftTrimmed = sql_ltrim(Name)\n\n% LENGTH - string length\nLen = sql_length(Name)\n\n% REPLACE - substitute text\nEmail = sql_replace(E, '@', ' at ')\n```\n\nFunctions can be nested:\n```prolog\nResult = sql_upper(sql_trim(Name))\n```", "source_file": "book-10-sql-target/10_sql_functions.md", "prerequisites": ["sql-func-001"]}
{"cluster_id": "sql-func-002", "question": "What date functions does the SQL target support?", "answer": "```prolog\n% DATE / DATETIME - extract/convert\nDateOnly = sql_date(OrderDate)\nDT = sql_datetime(OrderDate)\n\n% DATE_ADD - add interval\nDueDate = sql_date_add(OrderDate, 7, days)  % days, months, years\n\n% DATE_DIFF - days between dates\nDays = sql_date_diff(ShipDate, OrderDate)\n\n% EXTRACT - get date parts\nYear = sql_extract(year, HireDate)   % year, month, day, hour, minute, second\nMonth = sql_extract(month, HireDate)\n\n% STRFTIME - custom format\nFormatted = sql_strftime('%Y-%m-%d', OrderDate)\n```\n\nFormat codes: `%Y` (year), `%m` (month), `%d` (day), `%H` (hour), `%M` (minute), `%S` (second)", "source_file": "book-10-sql-target/10_sql_functions.md", "prerequisites": ["sql-func-001"]}
{"cluster_id": "sql-func-002", "question": "How do I use pattern matching in the SQL target?", "answer": "**BETWEEN** - range test:\n```prolog\nmid_salary(Name, Salary) :-\n    employees(_, Name, _, Salary, _, _),\n    sql_between(Salary, 50000, 100000).\n\n% Also: sql_not_between(Salary, 40000, 80000)\n```\n\n**LIKE** - wildcard matching:\n```prolog\n% % matches any sequence, _ matches single char\nj_names(Name) :- employees(_, Name, _, _, _, _), sql_like(Name, 'J%').\nson_names(Name) :- employees(_, Name, _, _, _, _), sql_like(Name, '%son%').\n\n% Also: sql_not_like(Name, 'Test%')\n```\n\n**IN** - list membership:\n```prolog\nengineering_depts(Name, Dept) :-\n    employees(_, Name, Dept, _, _, _),\n    sql_in(Dept, [engineering, 'r&d', development]).\n\n% Also: sql_not_in(Dept, [admin, hr])\n```", "source_file": "book-10-sql-target/10_sql_functions.md", "prerequisites": ["sql-func-001"]}
