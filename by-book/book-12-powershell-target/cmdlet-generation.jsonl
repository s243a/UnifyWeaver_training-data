{"cluster_id": "ps-cmdlet-001", "question": "How do I generate PowerShell cmdlets with CmdletBinding?", "answer": "Use `cmdlet_binding(true)` to generate advanced functions:\n\n```prolog\n?- compile_to_powershell(parent/2, [\n       cmdlet_name('Get-Parent'),\n       cmdlet_binding(true),\n       verbose_output(true)\n   ], Code).\n```\n\n**Generated:**\n```powershell\nfunction Get-Parent {\n    [CmdletBinding()]\n    param(\n        [Parameter(Position=0)]\n        [ValidateNotNullOrEmpty()]\n        [string]$Parent,\n        \n        [Parameter(Position=1, ValueFromPipeline=$true)]\n        [string]$Child\n    )\n    \n    begin { Write-Verbose \"Loading facts...\" }\n    process { # ... implementation }\n    end { Write-Verbose \"Query complete\" }\n}\n```\n\nCmdletBinding enables `-Verbose`, `-Debug`, `-ErrorAction` and other common parameters.", "source_file": "book-12-powershell-target/03_cmdlet_generation.md", "prerequisites": ["ps-facts-001"]}
{"cluster_id": "ps-cmdlet-001", "question": "What parameter attributes can I use in generated cmdlets?", "answer": "Common validation attributes:\n\n| Attribute | Purpose |\n|-----------|---------|\n| `[ValidateNotNullOrEmpty()]` | Reject null/empty |\n| `[ValidateRange(1, 100)]` | Numeric bounds |\n| `[ValidateSet('a','b','c')]` | Allowed values |\n| `[ValidatePattern('^[A-Z]')]` | Regex match |\n| `[ValidateScript({...})]` | Custom validation |\n\n**Parameter options:**\n```powershell\n[Parameter(\n    Mandatory=$true,\n    Position=0,\n    ValueFromPipeline=$true,\n    ValueFromPipelineByPropertyName=$true,\n    HelpMessage='Enter a name'\n)]\n[Alias('N', 'PersonName')]\n[string]$Name\n```\n\nThe compiler maps Prolog constraints to these attributes.", "source_file": "book-12-powershell-target/03_cmdlet_generation.md", "prerequisites": ["ps-cmdlet-001"]}
{"cluster_id": "ps-cmdlet-002", "question": "How do Begin/Process/End blocks work in generated cmdlets?", "answer": "Three execution phases for pipeline processing:\n\n**Begin** - Runs once before processing:\n```powershell\nbegin {\n    Write-Verbose \"Initializing...\"\n    $script:facts = Load-Facts  # Load once\n    $script:index = @{}  # Build indexes\n}\n```\n\n**Process** - Runs once per pipeline item:\n```powershell\nprocess {\n    Write-Verbose \"Processing: $_\"\n    if ($script:index.ContainsKey($_)) {\n        $script:index[$_]\n    }\n}\n```\n\n**End** - Runs after all input processed:\n```powershell\nend {\n    Write-Verbose \"Cleanup...\"\n    # Emit aggregated results, clean up\n}\n```\n\nThis pattern enables efficient batch processing: load facts once, process many items.", "source_file": "book-12-powershell-target/03_cmdlet_generation.md", "prerequisites": ["ps-cmdlet-001"]}
